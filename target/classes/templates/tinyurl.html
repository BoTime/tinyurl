<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head> 
    <title>Getting Started: Serving Web Content</title> 
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!-- <script src="jquery-3.4.1.min.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>
<body>
    <!-- <p th:text="'Hello, ' + ${name} + '!'" /> -->
    <form id="url-generator-form">
        <div>
            <input type="text" id="originalUrl"/> 
            <input type="submit" text="generate"/>
        </div>
        <div id="tinyUrl"></div>
    </form>

    <script type="text/javascript">
        jQuery(document).ready(function($) {
            $("#url-generator-form").submit(function(event) {
                // Prevent the form from submitting via the browser.
                event.preventDefault();
                let originalUrl = "";
                getTinyUrl();
            });
        });
	
	function getTinyUrl() {
		let data = {
            "originalUrl": ""
        };
        data["originalUrl"] = $("#originalUrl").val();
        console.log("original url:");
        console.log(data["originalUrl"]);
		
		$.ajax({
			type : "POST",
			contentType : "application/json",
			url : "tinyurl",
			data : JSON.stringify(data),
			dataType : 'json',
			timeout : 100000,
			success : function(data) {
				console.log("SUCCESS: ", data);
                $("#tinyUrl").text("localhost:8080/redirect?url=" + data["tinyUrl"]);
			},
			error : function(e) {
				console.log("ERROR: ", e);
			},
			done : function(e) {
				console.log("DONE");
            },
		});
	}
    </script>
</body>
</html>
